<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-back-end/drupal/drupal-config-management">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Configuration Management | idfive Developer Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://developers.idfive.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://developers.idfive.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://developers.idfive.com/docs/back-end/drupal/drupal-config-management"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Configuration Management | idfive Developer Documentation"><meta data-rh="true" name="description" content="It is important to remember that, in D8, all configuration, once imported, is owned by the DB/site. The configuration system is simply a way to set or update configuration on a site. By default, the config management of D8 assumes that it is managing config per instances of the &quot;same site&quot;, ie dev/stg/prod. If you are doing things other than that, you will need to make some changes, as well as be wary of things like UUID&#x27;s."><meta data-rh="true" property="og:description" content="It is important to remember that, in D8, all configuration, once imported, is owned by the DB/site. The configuration system is simply a way to set or update configuration on a site. By default, the config management of D8 assumes that it is managing config per instances of the &quot;same site&quot;, ie dev/stg/prod. If you are doing things other than that, you will need to make some changes, as well as be wary of things like UUID&#x27;s."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://developers.idfive.com/docs/back-end/drupal/drupal-config-management"><link data-rh="true" rel="alternate" href="https://developers.idfive.com/docs/back-end/drupal/drupal-config-management" hreflang="en"><link data-rh="true" rel="alternate" href="https://developers.idfive.com/docs/back-end/drupal/drupal-config-management" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://2PJMDLEUFN-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="idfive Developer Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="idfive Developer Documentation Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="idfive Developer Documentation" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.a60064a0.css">
<link rel="preload" href="/assets/js/runtime~main.943d03df.js" as="script">
<link rel="preload" href="/assets/js/main.5c70b3a5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-idfive.svg" alt="idfive Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-idfive.svg" alt="idfive Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/general">Documentation</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/general">General</a><button aria-label="Toggle the collapsible sidebar category &#x27;General&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/front-end">Front End</a><button aria-label="Toggle the collapsible sidebar category &#x27;Front End&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/support">Support</a><button aria-label="Toggle the collapsible sidebar category &#x27;Support&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/back-end">Back End</a><button aria-label="Toggle the collapsible sidebar category &#x27;Back End&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/drupal">Drupal</a><button aria-label="Toggle the collapsible sidebar category &#x27;Drupal&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-caching">Caching in drupal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/back-end/drupal/drupal-config-management">Configuration Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-entities">Entities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-entity-queries">Entity queries in drupal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-environment">idfive drupal environment and common setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-feeds">Feeds module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-field-snippets">Drupal Field Snippets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-helpfull-commands">Helpful Drupal Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-hybrid-content-types">Hybrid Content Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-js">Javascript and drupal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-legacy">Drupal 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-performance">Drupal Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-rest-custom">Custom REST endpoints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-services">Drupal 8 Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-seven-migration">Seven to 9 migration locally via lando</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-simple-password-protection">Simple (per page) password protection in drupal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-simplesamlphp-password-protection">Simplesamlphp (per page) password protection in drupal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-sitebuilding">Drupal 8 Site Building</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-social-share">Drupal Social Share</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-testing">Testing in drupal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-updates">Drupal Updates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-users-roles">Drupal Users and Roles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal/drupal-views">Drupal Views</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/back-end/drupal">Drupal 8 General Codebase</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/php">PHP</a><button aria-label="Toggle the collapsible sidebar category &#x27;PHP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/terminalfour-t4">TerminalFour (T4)</a><button aria-label="Toggle the collapsible sidebar category &#x27;TerminalFour (T4)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/wordpress">Wordpress</a><button aria-label="Toggle the collapsible sidebar category &#x27;Wordpress&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/challenges">Challenges</a><button aria-label="Toggle the collapsible sidebar category &#x27;Challenges&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/back-end"><span itemprop="name">Back End</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/drupal"><span itemprop="name">Drupal</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Configuration Management</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Configuration Management</h1><p>It is important to remember that, in D8, all configuration, once imported, is owned by the DB/site. The configuration system is simply a way to set or update configuration on a site. By default, the config management of D8 assumes that it is managing config per instances of the &quot;same site&quot;, ie dev/stg/prod. If you are doing things other than that, you will need to make some changes, as well as be wary of things like UUID&#x27;s.</p><p>It is important before beginning a full site build project to identify how/where site config will be managed. It is not always necessary to set up configuration sync folders, just be sure to think of the following if you do.</p><ul><li>By default this directory lives in DRUPALROOT/sites/default/files.</li><li>The location folder sometimes depends on the host, and following their best practices.</li><li>Configuration Manager module may be enabled, or it could all happen via drush.</li><li>Be sure all developers on the project know the plan, regardless of which route is chosen.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="checking-status">Checking status<a href="#checking-status" class="hash-link" aria-label="Direct link to Checking status" title="Direct link to Checking status">​</a></h2><p>As part of a CI process, or just before updating a feature/etc, you should see if new config is available, or if things have been changed. This can be done via:</p><ul><li><code>drush config:status</code> (drush 9 and above)</li><li>Navigating to the config management UI page, and visually checking for differences in yml vs DB config.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overriding-config-in-settingsphp">Overriding config in settings.php<a href="#overriding-config-in-settingsphp" class="hash-link" aria-label="Direct link to Overriding config in settings.php" title="Direct link to Overriding config in settings.php">​</a></h2><p>Sometimes it is desireable to override some config via settings.php. Usually, this is when you require different values for dev/stg/prod/etc. For example, to turn a SAML module off for local development. It is important to wrap these in a check for which environment is being targeted.</p><p>It is important to note, until core is patched (if it is patched), these override values WILL NOT show in the configuration forms of the site. These will need to be viewed/confirmed using <code>drush config:get DESIRED.CONFIG --include-overridden</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-env-check-and-config-override-on-acquia">Example env check, and config override on acquia<a href="#example-env-check-and-config-override-on-acquia" class="hash-link" aria-label="Direct link to Example env check, and config override on acquia" title="Direct link to Example env check, and config override on acquia">​</a></h3><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Check/modify any acquia environment specific modifications needed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (isset($_ENV[&#x27;AH_SITE_ENVIRONMENT&#x27;])) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  switch ($_ENV[&#x27;AH_SITE_ENVIRONMENT&#x27;]) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case &#x27;dev&#x27;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Config changes on DEV here.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case &#x27;test&#x27;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Config changes on STG here.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case &#x27;prod&#x27;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Config changes on PROD here.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Config changes on LOCAL here.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $config[&#x27;simplesamlphp_auth.settings&#x27;] = [&#x27;activate&#x27; =&gt; FALSE];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-config-variables-to-override">Finding config variables to override<a href="#finding-config-variables-to-override" class="hash-link" aria-label="Direct link to Finding config variables to override" title="Direct link to Finding config variables to override">​</a></h3><p>You may either scour the config sync directory, or look via drush:</p><ul><li><code>drush config:list</code></li><li>Choose the desired config item</li><li><code>drush config:get CHOSEN_CONFIG</code></li></ul><p>So for example, overriding the Site Name and front page path in settings.php could look like:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$config[&#x27;system.site&#x27;][&#x27;name&#x27;] = &quot;MYSITE DEV&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$config[&#x27;system.site&#x27;][&#x27;page&#x27;][&#x27;front&#x27;] = &quot;/node/NID&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="config-management-and-acquia">Config management and acquia<a href="#config-management-and-acquia" class="hash-link" aria-label="Direct link to Config management and acquia" title="Direct link to Config management and acquia">​</a></h2><p>Acquia recommends that the config folder be moved to be a sibling of docroot. Acquia config folder changes need to be loaded AFTER default settings in settings.php for acquia sites, for example:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Acquias default settings for a site</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (file_exists(&#x27;/var/www/site-php&#x27;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  require &#x27;/var/www/site-php/hud8/MYSITE-settings.inc&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Keep config/sync settings after acquia loads defaults.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Otherwise it ignores them and uses loaded defaults.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$config_directories[&#x27;vcs&#x27;] = $app_root . &#x27;/../config/MYSITE&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$config_directories[&#x27;sync&#x27;] = $app_root . &#x27;/../config/MYSITE&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-time-config-overrides-via-drush">One time config overrides via drush<a href="#one-time-config-overrides-via-drush" class="hash-link" aria-label="Direct link to One time config overrides via drush" title="Direct link to One time config overrides via drush">​</a></h2><p>You can use <a href="https://drushcommands.com/drush-8x/config/config-set/" target="_blank" rel="noopener noreferrer">drush config:set</a> to run one time updates on sites if needed. Note that booleans will need to be set as 1/0.</p><ul><li>See all config: <code>drush config:list</code></li><li>Narrow down: <code>drush config:list simplesamlphp_auth.settings</code></li><li>See Items (if needed): <code>drush config:get simplesamlphp_auth.settings</code></li><li>Set (string/num): <code>drush config:set simplesamlphp_auth.settings role.eval_every_time 0</code></li><li>Set (array): <code>drush config:set antibot.settings form_ids.5 &#x27;webform_*&#x27;</code> This sets the 5th array item as a single new value.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="config-management-and-modules">Config management and modules<a href="#config-management-and-modules" class="hash-link" aria-label="Direct link to Config management and modules" title="Direct link to Config management and modules">​</a></h2><p>If a more module based workflow is being employed, any config related to that module should be stored in the module itself. This is so that when users enable the module, all config that is relevant (fields/etc) are added.</p><p>Once that configuration has been imported into the site&#x27;s active configuration, however, it is owned by the site and not the module. This means that the module can provide default configuration which is provided to the site, but once installed, the site--not the module--owns the configuration and can make changes to it without interference from the module.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MY_MODULE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ALL CONFIG YML FILES FOR MODULE HERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MY_MODULE.module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MY_MODULE.info.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="config-export-for-the-module">Config export for the module<a href="#config-export-for-the-module" class="hash-link" aria-label="Direct link to Config export for the module" title="Direct link to Config export for the module">​</a></h3><p>Normally, it is easiest to:</p><ul><li>Export a full site export.</li><li>Move all needed config YML&#x27;s for the module from that export to the relevant modules config/install folder.</li><li>Remove the UUID from each YML file in that folder.</li><li>Test on a new install.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="config-updates-in-modules">Config updates in modules<a href="#config-updates-in-modules" class="hash-link" aria-label="Direct link to Config updates in modules" title="Direct link to Config updates in modules">​</a></h3><p>Updates to a module&#x27;s default configuration need to include changes to the YAML files in config/install and/or config/optional for new users of the module, but the module also must implement an update hook for existing users in order for the configuration changes to be loaded. This is because config/install is not read again after installation and configuration in config/optional may also already be active if dependencies on the site were installed.</p><p>To update a module that is used on multiple sites, you must:</p><ul><li>Update all config YML files.This is so that any &quot;new&quot; install of the module gets the correct config.</li><li>Utilize hook_update in order to modify config on &quot;existing&quot; sites.</li><li>Be sure to add any dependencies in the modules MY_MODULE.info.yml, that the config needs, ie a field type created by a contrib module.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="update-specific-config-via-an-update-hook">Update specific config via an update hook<a href="#update-specific-config-via-an-update-hook" class="hash-link" aria-label="Direct link to Update specific config via an update hook" title="Direct link to Update specific config via an update hook">​</a></h4><p>Normal single value field:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Updates to something like a single value.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function MY_MODULE_update_8001() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $config = \Drupal::service(&#x27;config.factory&#x27;)-&gt;getEditable(&#x27;CONFIG.TO_LOAD&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $config-&gt;set(&#x27;VALUE.TO_SET&#x27;, &#x27;bar&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $config-&gt;save();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Multivalue settings:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Updates to something like a media browser.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function MY_MODULE_update_8001() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $config = \Drupal::service(&#x27;config.factory&#x27;)-&gt;getEditable(&#x27;CONFIG.TO_LOAD&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $data = [&#x27;VALUE&#x27;, &#x27;ANOTHER VALUE&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $config-&gt;set(&#x27;VALUE.TO_SET&#x27;, $data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $config-&gt;save();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Removing config:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Drupal::configFactory()-&gt;getEditable(&#x27;CONFIG.TO_REMOVE&#x27;)-&gt;delete();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This can be added to a hook_uninstall, or run via drush as below, by temporarily creating a function in an in-use module:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Function added to an in-use module temporarily.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function tempDropEntity() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Drupal::configFactory()-&gt;getEditable(&#x27;CONFIG.TO_REMOVE&#x27;)-&gt;delete();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then running drush command <code>drush php-eval &quot;tempDropEntity();&quot;</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="update-all-config">Update all config<a href="#update-all-config" class="hash-link" aria-label="Direct link to Update all config" title="Direct link to Update all config">​</a></h4><p>An example hook_update to simply &quot;reinstall all config for a GIVEN module&quot;.
This assumes all YML files have been added/updated. You can also programmatically add fields/etc, this is simply a quick way to update all config for a module.</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * DESCRIPTIVE UPDATE TEXT HERE.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function MY_MODULE_update_8001() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  \Drupal::service(&#x27;config.installer&#x27;)-&gt;installDefaultConfig(&#x27;module&#x27;, &#x27;MY_MODULE&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="programmatically-remove-fields">Programmatically remove fields<a href="#programmatically-remove-fields" class="hash-link" aria-label="Direct link to Programmatically remove fields" title="Direct link to Programmatically remove fields">​</a></h4><p>&quot;Update all config&quot; as shown above, has the caveat tht it will not REMOVE fields, it simply leaves them in place.</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use Drupal\field\Entity\FieldConfig;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * DESCRIPTIVE UPDATE TEXT HERE.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function MY_MODULE_update_8001() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Deleting old field.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (FieldConfig::loadByName(&#x27;ENTITY_TYPE&#x27;, &#x27;BUNDLE&#x27;, &#x27;MY_FIELD&#x27;) !== NULL ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FieldConfig::loadByName(&#x27;ENTITY_TYPE&#x27;, &#x27;BUNDLE&#x27;, &#x27;MY_FIELD&#x27;)-&gt;delete();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="programmatically-remove-all-content-and-entity">Programmatically remove all content and entity<a href="#programmatically-remove-all-content-and-entity" class="hash-link" aria-label="Direct link to Programmatically remove all content and entity" title="Direct link to Programmatically remove all content and entity">​</a></h4><p>Removes all content of a bundle, and the bundle, then re-installs fresh.</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use Drupal\field\Entity\FieldConfig;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * DESCRIPTIVE UPDATE TEXT HERE.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function MY_MODULE_update_8001() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Delete existing paragraphs content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $paragraphs = \Drupal::entityTypeManager()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -&gt;getStorage(&#x27;paragraph&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -&gt;loadByProperties(array(&#x27;type&#x27; =&gt; &#x27;MY_PARAGRAPH_BUNDLE&#x27;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foreach ($paragraphs as $paragraph) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $paragraph-&gt;delete();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Delete entire paragraph type bundle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $para_type = \Drupal::entityTypeManager()-&gt;getStorage(&#x27;paragraphs_type&#x27;)-&gt;load(&#x27;MY_PARAGRAPH_BUNDLE&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($para_type !== NULL) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $para_type-&gt;delete();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Re-install fresh config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  \Drupal::service(&#x27;config.installer&#x27;)-&gt;installDefaultConfig(&#x27;module&#x27;, &#x27;MY_MODULE&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="programmatically-change-plain-text-field-to-wysiwyg">Programmatically change plain text field to WYSIWYG<a href="#programmatically-change-plain-text-field-to-wysiwyg" class="hash-link" aria-label="Direct link to Programmatically change plain text field to WYSIWYG" title="Direct link to Programmatically change plain text field to WYSIWYG">​</a></h4><p>Makes a copy of data before removing the old field, adding new field, and repopulating.</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use \Drupal\field\Entity\FieldStorageConfig;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use \Drupal\field\Entity\FieldConfig;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Change FIELD_MY_FIELD field from string (plain text) to text(formatted).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function MY_MODULE_update_8001() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $fields = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;FIELD_MY_FIELD&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;table&#x27; =&gt; &#x27;paragraph__FIELD_MY_FIELD&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;revision_table&#x27; =&gt; &#x27;paragraph_revision__FIELD_MY_FIELD&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;format_col&#x27; =&gt; &#x27;FIELD_MY_FIELD_format&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $database = \Drupal::database();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foreach ($fields as $field_name =&gt; $f) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $table = $f[&#x27;table&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $revision_table = $f[&#x27;revision_table&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $entity_type = &#x27;paragraph&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Get field storage.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $field_storage = FieldStorageConfig::loadByName($entity_type, $field_name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Check if field exist.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (is_null($field_storage)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      continue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Store data to an array so that we can restore it once the update is complete.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $rows = NULL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $revision_rows = NULL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($database-&gt;schema()-&gt;tableExists($table)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $rows = $database-&gt;select($table, &#x27;n&#x27;)-&gt;fields(&#x27;n&#x27;)-&gt;execute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -&gt;fetchAll();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $revision_rows = $database-&gt;select($revision_table, &#x27;n&#x27;)-&gt;fields(&#x27;n&#x27;)-&gt;execute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -&gt;fetchAll();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Save new field configs &amp; delete existing fields.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $new_fields = array();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foreach ($field_storage-&gt;getBundles() as $bundle =&gt; $label) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $field = FieldConfig::loadByName($entity_type, $bundle, $field_name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $new_field = $field-&gt;toArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $new_field[&#x27;field_type&#x27;] = &#x27;text_long&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $new_fields[] = $new_field;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Delete field.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $field-&gt;delete();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create new storage configs from existing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $new_field_storage = $field_storage-&gt;toArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $new_field_storage[&#x27;type&#x27;] = &#x27;text_long&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $new_field_storage[&#x27;module&#x27;] = &#x27;text_long&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Purge deleted fields data to create new fields.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    field_purge_batch(250);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create new fieldstorage.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FieldStorageConfig::create($new_field_storage)-&gt;save();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create new fields for all bundles.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    foreach ($new_fields as $new_field) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $new_field = FieldConfig::create($new_field);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $new_field-&gt;save();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Restore existing data in fields &amp; revision tables.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!is_null($rows)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      foreach ($rows as $row) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $row = (array) $row;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $row[$f[&#x27;format_col&#x27;]] = &#x27;full_html&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $database-&gt;insert($table)-&gt;fields($row)-&gt;execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!is_null($revision_rows)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      foreach ($revision_rows as $row) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $row = (array) $row;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $row[$f[&#x27;format_col&#x27;]] = &#x27;full_html&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $database-&gt;insert($revision_table)-&gt;fields($row)-&gt;execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-config-setups">Advanced config setups<a href="#advanced-config-setups" class="hash-link" aria-label="Direct link to Advanced config setups" title="Direct link to Advanced config setups">​</a></h2><p>More advanced config setups should consider using the <a href="https://www.drupal.org/project/config_split" target="_blank" rel="noopener noreferrer">config split</a> module.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/back-end/drupal/drupal-config-management.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/back-end/drupal/drupal-caching"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Caching in drupal</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/back-end/drupal/drupal-entities"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Entities</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#checking-status" class="table-of-contents__link toc-highlight">Checking status</a></li><li><a href="#overriding-config-in-settingsphp" class="table-of-contents__link toc-highlight">Overriding config in settings.php</a><ul><li><a href="#example-env-check-and-config-override-on-acquia" class="table-of-contents__link toc-highlight">Example env check, and config override on acquia</a></li><li><a href="#finding-config-variables-to-override" class="table-of-contents__link toc-highlight">Finding config variables to override</a></li></ul></li><li><a href="#config-management-and-acquia" class="table-of-contents__link toc-highlight">Config management and acquia</a></li><li><a href="#one-time-config-overrides-via-drush" class="table-of-contents__link toc-highlight">One time config overrides via drush</a></li><li><a href="#config-management-and-modules" class="table-of-contents__link toc-highlight">Config management and modules</a><ul><li><a href="#config-export-for-the-module" class="table-of-contents__link toc-highlight">Config export for the module</a></li><li><a href="#config-updates-in-modules" class="table-of-contents__link toc-highlight">Config updates in modules</a></li></ul></li><li><a href="#advanced-config-setups" class="table-of-contents__link toc-highlight">Advanced config setups</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 idfive.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.943d03df.js"></script>
<script src="/assets/js/main.5c70b3a5.js"></script>
</body>
</html>
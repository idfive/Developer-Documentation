"use strict";(self.webpackChunkidfive_docs=self.webpackChunkidfive_docs||[]).push([[5390],{6175:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"back-end/drupal/drupal-seven-migration","title":"Seven to 9 migration locally via lando","description":"See https://www.drupal.org/docs/upgrading-drupal/upgrade-using-drush. These are notes to be more sussed out on next run.","source":"@site/docs/back-end/drupal/drupal-seven-migration.md","sourceDirName":"back-end/drupal","slug":"/back-end/drupal/drupal-seven-migration","permalink":"/docs/back-end/drupal/drupal-seven-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/idfive/Developer-Documentation/tree/main/docs/back-end/drupal/drupal-seven-migration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Drupal 8 Services","permalink":"/docs/back-end/drupal/drupal-services"},"next":{"title":"Simple (per page) password protection in drupal","permalink":"/docs/back-end/drupal/drupal-simple-password-protection"}}');var d=n(4848),l=n(8453);const s={},i="Seven to 9 migration locally via lando",o={},t=[{value:"Troubleshooting",id:"troubleshooting",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.header,{children:(0,d.jsx)(r.h1,{id:"seven-to-9-migration-locally-via-lando",children:"Seven to 9 migration locally via lando"})}),"\n",(0,d.jsxs)(r.p,{children:["See ",(0,d.jsx)(r.a,{href:"https://www.drupal.org/docs/upgrading-drupal/upgrade-using-drush",children:"https://www.drupal.org/docs/upgrading-drupal/upgrade-using-drush"}),". These are notes to be more sussed out on next run."]}),"\n",(0,d.jsx)(r.p,{children:"This approach uses lando to create a seperate DB locally."}),"\n",(0,d.jsxs)(r.ul,{children:["\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.code,{children:"lando composer require drupal/migrate_plus"})}),"\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.code,{children:"lando composer require drupal/migrate_tools"})}),"\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.code,{children:"lando composer require drupal/migrate_file"})}),"\n"]}),"\n",(0,d.jsx)(r.p,{children:"Eaxmple lando.yml:"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-yml",children:"name: mywebsite\nrecipe: drupal8\nconfig:\n  webroot: web\n\n# Create Drupal 7 database service, for migration\nservices:\n  d7db:\n    type: mariadb\n    creds:\n      user: drupal7db\n      password: drupal7db\n      database: drupal7db\n    portforward: true\n"})}),"\n",(0,d.jsx)(r.p,{children:"example setings.php:"}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-php",children:"$databases['migrate']['default'] = [\n  'database' => 'drupal7db',\n  'username' => 'drupal7db',\n  'password' => 'drupal7db',\n  'prefix' => '',\n  'host' => 'd7db',\n  'port' => '3306',\n  'namespace' => 'Drupal\\\\Core\\\\Database\\\\Driver\\\\mysql',\n  'driver' => 'mysql',\n];\n"})}),"\n",(0,d.jsxs)(r.ul,{children:["\n",(0,d.jsxs)(r.li,{children:["Download the D7 DB, and install into lando locally via ",(0,d.jsx)(r.code,{children:"lando db-import --host=d7db --user=drupal7db MY_DB.sql"}),"."]}),"\n",(0,d.jsxs)(r.li,{children:["View the available migrations to later run: ",(0,d.jsx)(r.code,{children:"lando drush migrate:upgrade --legacy-db-key=migrate --legacy-root=https://MY-SITE.com --configure-only"}),"."]}),"\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.code,{children:"lando drush migrate:status"})}),"\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.code,{children:"lando drush migrate:import --all"})}),"\n",(0,d.jsxs)(r.li,{children:["Import all d7 ",(0,d.jsx)(r.code,{children:'lando drush migrate:import --tag="Drupal 7"'})]}),"\n",(0,d.jsxs)(r.li,{children:["Reset ",(0,d.jsx)(r.code,{children:"lando drush migrate-rollback --all"})]}),"\n"]}),"\n",(0,d.jsx)(r.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,d.jsxs)(r.ul,{children:["\n",(0,d.jsxs)(r.li,{children:["See why a migration failed: ",(0,d.jsx)(r.code,{children:"lando drush mmsg MIGRATION_NAME"})]}),"\n",(0,d.jsxs)(r.li,{children:['"Migration MIGRATION_NAME is busy with another operation: Importing": ',(0,d.jsx)(r.code,{children:"lando drush migrate-reset-status MIGRATION_NAME"}),", resets that operation to idle in order to rerun."]}),"\n",(0,d.jsx)(r.li,{children:'"The "ENTITY" entity type does not exist": See if modules enabled'}),"\n",(0,d.jsxs)(r.li,{children:["Files not Importing: run ",(0,d.jsx)(r.code,{children:"lando drush migrate-import upgrade_d7_file"})," directly"]}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,d.jsx)(r,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>i});var a=n(6540);const d={},l=a.createContext(d);function s(e){const r=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),a.createElement(l.Provider,{value:r},e.children)}}}]);
"use strict";(self.webpackChunkidfive_docs=self.webpackChunkidfive_docs||[]).push([[2834],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=o.createContext({}),p=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(a),m=n,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||r;return a?o.createElement(h,s(s({ref:t},c),{},{components:a})):o.createElement(h,s({ref:t},c))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,s=new Array(r);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[d]="string"==typeof e?e:n,s[1]=i;for(var p=2;p<r;p++)s[p]=a[p];return o.createElement.apply(null,s)}return o.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7542:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var o=a(7462),n=(a(7294),a(3905));const r={},s="Composer",i={unversionedId:"back-end/php/composer",id:"back-end/php/composer",title:"Composer",description:"Create",source:"@site/docs/back-end/php/composer.md",sourceDirName:"back-end/php",slug:"/back-end/php/composer",permalink:"/docs/back-end/php/composer",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/back-end/php/composer.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"PHP",permalink:"/docs/category/php"},next:{title:"PHP",permalink:"/docs/back-end/php/standards"}},l={},p=[{value:"Create",id:"create",level:2},{value:"The Composer.json File",id:"the-composerjson-file",level:2},{value:"Require/Remove",id:"requireremove",level:2},{value:"Version Ranges",id:"version-ranges",level:3},{value:"Tilde",id:"tilde",level:4},{value:"Caret",id:"caret",level:4},{value:"Deploy",id:"deploy",level:2},{value:"Maintain",id:"maintain",level:2},{value:"Maintaining Projects that Have Composer Dependencies",id:"maintaining-projects-that-have-composer-dependencies",level:2},{value:"Drupal 8 and Composer",id:"drupal-8-and-composer",level:2},{value:"Set Up",id:"set-up",level:2},{value:"Manage",id:"manage",level:2}],c={toc:p},d="wrapper";function u(e){let{components:t,...r}=e;return(0,n.kt)(d,(0,o.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"composer"},"Composer"),(0,n.kt)("h2",{id:"create"},"Create"),(0,n.kt)("p",null,"Composer projects are generally created by entering the command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer init\n")),(0,n.kt)("p",null,"This command (run from within the project directory), leads the developer through the creation of a composer.json file."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"alt_text",src:a(9351).Z,title:"image_tooltip",width:"1298",height:"404"})),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"The composer init command leads the user through the creation of a composer.json file")),(0,n.kt)("p",null,"The interactive init command allows the developer to define dependencies at init time. But dependencies can also be added using the require command."),(0,n.kt)("h2",{id:"the-composerjson-file"},"The Composer.json File"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"alt_text",src:a(997).Z,title:"image_tooltip",width:"1434",height:"686"})),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"The composer.json file for the howard content types Drupal module lists metadata for the project")),(0,n.kt)("p",null,"The init command builds the composer.json file. The official ",(0,n.kt)("a",{parentName:"p",href:"https://getcomposer.org/doc/04-schema.md"},"Composer documentation")," lists all the properties that may be added to composer.json. The only properties that are required are the name and description fields. However, there are a number of other properties that can be added to give more information about the project. These include:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"authors")," - An array of author objects, which may each have name, email, homepage, and role property"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"support")," - An object containing various ways to get support including irc, email, issue tracker, etc."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"license")," - Under which license(s) is the package distributed"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"homepage")," - The homepage of the project")),(0,n.kt)("p",null,"Other information in the composer.json file lists information about dependencies of the package."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"require")," - (see above) Lists the dependencies of this package. As long as a nonconflicting versions of packages can be found that meets the constraints in composer.json, they will be downloaded on install."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"minimum-stability")," - Sets a minimum for how stable packages need to be to be included. Possible values are dev, alpha, beta, RC, and stable, Defaults to stable")),(0,n.kt)("h2",{id:"requireremove"},"Require/Remove"),(0,n.kt)("p",null,"After the ",(0,n.kt)("inlineCode",{parentName:"p"},"init")," command has been run, dependencies can be added and removed from the composer.json file with the ",(0,n.kt)("inlineCode",{parentName:"p"},"require")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"remove")," commands. Composer ",(0,n.kt)("inlineCode",{parentName:"p"},"require")," adds a new dependency to the project and ",(0,n.kt)("inlineCode",{parentName:"p"},"remove")," removes it."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer require VENDOR/PROJECT\n")),(0,n.kt)("p",null,"Where the vendor is the collection within composer, usually the company, individual, or organization (in the case of Howard University repos ",(0,n.kt)("em",{parentName:"p"},"howard"),") and project is the name of this particular package. For example, the howard_paragraphs (howard/howard/paragraphs) project has the following requirements:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'"drupal/external_data_source": "*",\n"drupal/paragraphs": "*",\n"drupal/tablefield": "*",\n"drupal/viewsreference": "*",\n"drupal/webform": "*"\n')),(0,n.kt)("p",null,"All of these are drupal modules required for this particular paragraph widgets. There is no indication of version for any of these dependencies, and so the latest version will be used."),(0,n.kt)("h3",{id:"version-ranges"},"Version Ranges"),(0,n.kt)("p",null,"You can require specific versions of packages to be installed on a project, but more common is allowing packages to be updated at least with some version constraints. Allowing a package to update without constraints can sometimes lead to an update that breaks the code, but allowing some updates can allow security patches and new features to get in as needed. Version constraints can be added to the require command to restrict which package versions can be downloaded by Composer."),(0,n.kt)("h4",{id:"tilde"},"Tilde"),(0,n.kt)("p",null,"The ",(0,n.kt)("strong",{parentName:"p"},"tilde")," (~) version range allows updating through the next version of higher specificity. For example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'composer require drupal/thing "~1.4"\n')),(0,n.kt)("p",null,"Will allow an update up to version 2; whereas:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'composer require drupal/thing "~1.4.3"\n')),(0,n.kt)("p",null,"Will allows updates up to version 1.5."),(0,n.kt)("h4",{id:"caret"},"Caret"),(0,n.kt)("p",null,"The ",(0,n.kt)("strong",{parentName:"p"},"caret")," (^) version range always allows updating up to the last non-breaking release. Under composer conventions, that means up to the next major release. So:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'composer require drupal/thing "^1.4"\n')),(0,n.kt)("p",null,"Will behave the same as the tilde version range because 2 is the next major release. Whereas:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'composer require drupal/thing "^1.4.3"\n')),(0,n.kt)("p",null,"Will also allow updates up to version 2, because all releases within one major release should be backwards compatible. When using the caret version range, the issue more often what is the minimum version required by the application, which may be more specific than a minor release."),(0,n.kt)("p",null,"Version ranges can also be scoped by comparison operators ( >, >=, <, <=, !=). More than one range can be combined, either with a space ( ) or a (,), which will be treated as an AND, or with a double pipe (||), which will be treated as an OR."),(0,n.kt)("h2",{id:"deploy"},"Deploy"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://packagist.org"},"Packagist")," is the website that manages Composer projects. It aggregates public PHP projects for installation via composer. We submit code we want distributed through composer to Packagist. Essentially we add a link to the project git repo in packagist, so it can route there when folks require it."),(0,n.kt)("p",null,"The official Packagist documentation has a ",(0,n.kt)("a",{parentName:"p",href:"https://packagist.org/about#naming-your-package"},"page")," for how to submit packages. The steps it lists are:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Naming your package"),(0,n.kt)("li",{parentName:"ul"},"Creating a composer.json file"),(0,n.kt)("li",{parentName:"ul"},"Managing package versions"),(0,n.kt)("li",{parentName:"ul"},"Update Schedule")),(0,n.kt)("p",null,"In short, Packagist provides a form that connects the package with a Github repository. As long as there is a properly made composer.json file, Packagist can pull version number from the tags in the Github repository."),(0,n.kt)("h2",{id:"maintain"},"Maintain"),(0,n.kt)("p",null,"The recommended way to update package versions and the way that idfive does it is outlined by Packagist as:"),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Enabling the Packagist service hook ensures that your package will always be updated instantly when you push to GitHub.")),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"To do so you can:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"Make sure you login via GitHub (if you already have an account not connected to GitHub, you can ",(0,n.kt)("a",{parentName:"em",href:"https://packagist.org/profile/edit"},"connect it on your profile"),"). If you are logged in already, log out first then login via GitHub again to make sure you grant us the required permissions.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"Make sure ",(0,n.kt)("a",{parentName:"em",href:"https://github.com/settings/connections/applications/a059f127e1c09c04aa5a"},"the Packagist application")," has access to all the GitHub organizations you need to publish packages from.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"Check ",(0,n.kt)("a",{parentName:"em",href:"https://packagist.org/profile/"},"your package list")," to see if any has a warning about not being automatically synced.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("em",{parentName:"li"},"If you still need to setup sync on some packages, try ",(0,n.kt)("a",{parentName:"em",href:"https://packagist.org/trigger-github-sync/"},"triggering a manual account sync")," to have Packagist try to set up hooks on your account again. Note that archived repositories can not be setup as they are readonly in GitHub's API."))),(0,n.kt)("p",null,"New tags pushed to the Github repository immediately triggers a new release."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"require")," - lists the dependencies of this package. As long as a nonconflicting versions of packages can be found that meets the constraints in composer.json, they will be downloaded on install."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"minimum-stability")," - sets a minimum for how stable packages need to be to be included. Possible values are dev, alpha, beta, RC, and stable, Defaults to stable")),(0,n.kt)("h2",{id:"maintaining-projects-that-have-composer-dependencies"},"Maintaining Projects that Have Composer Dependencies"),(0,n.kt)("p",null,"In the root of a composer project is a composer.json file and a composer.lock file (The ",(0,n.kt)("a",{parentName:"p",href:"https://getcomposer.org/doc/01-basic-usage.md#commit-your-composer-lock-file-to-version-control"},"composer documentation")," says composer.lock should be put under version control so that collaborators install the right version of each dependency). There may also be a vendor directory if composer install has been run. To check if there are updates to dependencies, run the outdated command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer outdated\n")),(0,n.kt)("p",null,"Outdated will query Packagist and then list the packages that have available updates. The output is color coded. Output that is coded yellow has a new version that may not be backwards compatible to the current version. Upgrading may involve debugging code. Output that is coded red is semver-compatible and you should upgrade it."),(0,n.kt)("p",null,"In contrast, use the ",(0,n.kt)("inlineCode",{parentName:"p"},"show")," command to see all composer packages."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"alt_text",src:a(6724).Z,title:"image_tooltip",width:"1320",height:"234"})),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Color coding of the composer outdated command.")),(0,n.kt)("p",null,"To upgrade, use the update command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer update VENDOR/PROJECT\n")),(0,n.kt)("p",null,"Composer will update the package listed in the command so long as it is not prohibited by constraints in composer.json or other dependencies. To update every package, leave off the package name, though be careful making such a big change. Wildcards are also allowed in the update command. For example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer update VENDOR/*\n")),(0,n.kt)("p",null,"Will update all packages of the named vendor."),(0,n.kt)("p",null,"To see why a package cannot be updated, use the prohibits command."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer prohibits symfony/polyfill-php72\n")),(0,n.kt)("p",null,"Which returns:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"symfony/var-dumper  v4.4.4  requires  symfony/polyfill-php72 (~1.5)\n")),(0,n.kt)("p",null,"Composer update will also update the composer.lock file, thus capturing a snapshot of exactly which packages and versions are installed on the project."),(0,n.kt)("h2",{id:"drupal-8-and-composer"},"Drupal 8 and Composer"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://www.drupal.org/docs/develop/using-composer"},"Drupal uses Composer")," to manage the various libraries it uses and it is a good idea to use Composer to manage the modules that make up a Drupal project."),(0,n.kt)("h2",{id:"set-up"},"Set Up"),(0,n.kt)("p",null,"Drupal can be downloaded and installed with composer and drush. In part to encourage the use of composer as a dependency manager, drush in Drupal 8 does not include the ",(0,n.kt)("inlineCode",{parentName:"p"},"dl")," command."),(0,n.kt)("p",null,"The official Drupal documentation has a good page on creating and managing a Drupal project with composer. To begin:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer create-project drupal/recommended-project <project directory>\n")),(0,n.kt)("p",null,"Will create a new Drupal project in the ",(0,n.kt)("em",{parentName:"p"},"project directory")," with the recommended-project template. The recommended-project template is the recommended composer template as of Drupal 8.8."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"alt_text",src:a(8391).Z,title:"image_tooltip",width:"1512",height:"936"})),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Output as the Drupal composer command runs.")),(0,n.kt)("p",null,"From here, the install script can be run from the browser or via drush with the ",(0,n.kt)("inlineCode",{parentName:"p"},"drush site:install")," command run."),(0,n.kt)("p",null,"Drush site:install (si) asks a series of questions to set up the project, including the database name, etc. to get the site up and running."),(0,n.kt)("h2",{id:"manage"},"Manage"),(0,n.kt)("p",null,"All modules and drupal core should be managed with composer. On the ",(0,n.kt)("a",{parentName:"p",href:"https://www.lullabot.com/articles/drupal-8-composer-best-practices"},"Lullabot blog")," James Sansbury makes a case for how complicated dependency management is and composer, with its ability to manage both first level dependencies and nested dependencies."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"composer update --with-dependencies drupal/MODULE_NAME\n")),(0,n.kt)("p",null,"Will update not only the module, but the dependencies of the module. Composer update updates code and the composer.lock file, which will need to be pushed to the repository. After running update, running git status will show the new code to stage, commit, and push."))}u.isMDXComponent=!0},6724:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image1-600d31a1d4bdbf7804ca3dec55801dcb.png"},8391:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image2-58d0a87aa7c9d6b0ab5c03d0c6dca477.png"},997:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image3-c9df4749f5f72b1a5f62ba3bf2615179.png"},9351:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image4-deeeb07b60c76ffe4596bc36823ae456.png"}}]);
"use strict";(self.webpackChunkidfive_docs=self.webpackChunkidfive_docs||[]).push([[6871],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>f});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),o=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=o(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,l=e.originalType,s=e.parentName,p=d(e,["components","mdxType","originalType","parentName"]),u=o(a),c=i,f=u["".concat(s,".").concat(c)]||u[c]||m[c]||l;return a?n.createElement(f,r(r({ref:t},p),{},{components:a})):n.createElement(f,r({ref:t},p))}));function f(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=a.length,r=new Array(l);r[0]=c;var d={};for(var s in t)hasOwnProperty.call(t,s)&&(d[s]=t[s]);d.originalType=e,d[u]="string"==typeof e?e:i,r[1]=d;for(var o=2;o<l;o++)r[o]=a[o];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},627:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>l,metadata:()=>d,toc:()=>o});var n=a(7462),i=(a(7294),a(3905));const l={},r="Drupal Field Snippets",d={unversionedId:"back-end/drupal/drupal-field-snippets",id:"back-end/drupal/drupal-field-snippets",title:"Drupal Field Snippets",description:"Helpful snippets for displaying different fields.",source:"@site/docs/back-end/drupal/drupal-field-snippets.md",sourceDirName:"back-end/drupal",slug:"/back-end/drupal/drupal-field-snippets",permalink:"/docs/back-end/drupal/drupal-field-snippets",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/back-end/drupal/drupal-field-snippets.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Feeds module",permalink:"/docs/back-end/drupal/drupal-feeds"},next:{title:"Helpful Drupal Commands",permalink:"/docs/back-end/drupal/drupal-helpfull-commands"}},s={},o=[{value:"Dates",id:"dates",level:2},{value:"Format date in preproccess",id:"format-date-in-preproccess",level:3},{value:"Truncate",id:"truncate",level:2},{value:"Hiding fields/sections/whatever using a boolean field",id:"hiding-fieldssectionswhatever-using-a-boolean-field",level:2},{value:"Classes in twig based on a boolean field",id:"classes-in-twig-based-on-a-boolean-field",level:2},{value:"Term Reference",id:"term-reference",level:2},{value:"Comma separated fancy, in node.html.twig",id:"comma-separated-fancy-in-nodehtmltwig",level:3},{value:"Link",id:"link",level:2},{value:"With attributes, in node.html.twig",id:"with-attributes-in-nodehtmltwig",level:3},{value:"Media and Image fields",id:"media-and-image-fields",level:2},{value:"Media field in twig",id:"media-field-in-twig",level:3},{value:"Media Field preproccess.",id:"media-field-preproccess",level:3},{value:"Image field",id:"image-field",level:3}],p={toc:o},u="wrapper";function m(e){let{components:t,...a}=e;return(0,i.kt)(u,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"drupal-field-snippets"},"Drupal Field Snippets"),(0,i.kt)("p",null,"Helpful snippets for displaying different fields."),(0,i.kt)("h2",{id:"dates"},"Dates"),(0,i.kt)("h3",{id:"format-date-in-preproccess"},"Format date in preproccess"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"$variables['created'] = \\Drupal::service('date.formatter')->format($variables['node']->getCreatedTime(), 'MY_DATE_FORMAT');\n")),(0,i.kt)("h2",{id:"truncate"},"Truncate"),(0,i.kt)("p",null,"Use the built in ",(0,i.kt)("a",{parentName:"p",href:"https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Component%21Utility%21Unicode.php/function/Unicode%3A%3Atruncate/8.2.x"},"Unicode truncate function"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use Drupal\\Component\\Utility\\Unicode;\n\n// Truncates a UTF-8-encoded string safely to a number of characters.\n$truncate = Unicode::truncate($string, $max_length, $wordsafe, $add_ellipsis, $min_wordsafe_length);\n\n$truncate = Unicode::truncate($MY_STRING, 200, TRUE, TRUE, 5);\n")),(0,i.kt)("h2",{id:"hiding-fieldssectionswhatever-using-a-boolean-field"},"Hiding fields/sections/whatever using a boolean field"),(0,i.kt)("p",null,'Sometimes it in necessary to use a boolean to hide/show different parts of a page. This can be accomplished by adding a field check in the proper entity hook (node/paragraph/whatever), and creating a custom variable. In this example we added a boolean that says "Hide something" to a node. In general, we prefer to say "hide something", rather than "show something", that way, all things can be displayed by default, and the feeling is more "this one instance is special and I am taking action to do something unique".'),(0,i.kt)("p",null,"In hook_preprocess_node:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"$hide_this_thing_chosen = $variables['elements']['#node']->BOOLEAN_FIELD_ON_NODE_TO_CONTROL_HIDING->value;\n$hide_this_thing = FALSE;\nif ($hide_this_thing_chosen == TRUE) {\n  $hide_this_thing = TRUE;\n}\n$variables['hide_this_thing'] = $hide_this_thing;\n")),(0,i.kt)("p",null,"Then in twig template:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"{% if not hide_this_thing %}\n  Conditional code/etc here...\n{% endif %}\n")),(0,i.kt)("h2",{id:"classes-in-twig-based-on-a-boolean-field"},"Classes in twig based on a boolean field"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"{%\n  set classes = [\n    'paragraph',\n    'paragraph--type--' ~ paragraph.bundle|clean_class,\n    content.FIELD_MY_FIELD|render|trim == 'On' ? 'paragraph--type--' ~ paragraph.bundle|clean_class ~ '__MY_CLASS_MODIFIER',\n  ]\n%}\n{% block paragraph %}\n\n<section{{ attributes.addClass(classes) }}>\n")),(0,i.kt)("h2",{id:"term-reference"},"Term Reference"),(0,i.kt)("h3",{id:"comma-separated-fancy-in-nodehtmltwig"},"Comma separated fancy, in node.html.twig"),(0,i.kt)("p",null,"If, for whatever reason you do not wish to override a field template, links can be accessed in the entity template."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If 1 value: My first term"),(0,i.kt)("li",{parentName:"ul"},"If 2 values: My first term and My second term"),(0,i.kt)("li",{parentName:"ul"},"If 3+ values: My first term, My second term, My third term and My fourth term")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"{% if content.MY_TERM_REFERENCE_FIELD %}\n  {%- for item in content.MY_TERM_REFERENCE_FIELD['#items'] -%}\n    {%- if loop.first -%}\n      {{- item.entity.name.value -}}\n    {%- elseif loop.last -%}\n      {{- ' and ' ~ item.entity.name.value -}}\n    {%- else -%}\n      {{- ', ' ~ item.entity.name.value -}}\n    {%- endif -%}\n  {%- endfor -%}\n{% endif %}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If 1 value: My first term"),(0,i.kt)("li",{parentName:"ul"},"If 2 values: My first term,My second term"),(0,i.kt)("li",{parentName:"ul"},"If 3+ values: My first term, My second term, My third term, My fourth term")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"{% if content.MY_TERM_REFERENCE_FIELD %}\n  {%- for item in content.MY_TERM_REFERENCE_FIELD['#items'] -%}\n    {%- if loop.last -%}\n      {{- item.entity.name.value -}}\n    {%- else -%}\n      {{-  item.entity.name.value ~ ', ' -}}\n    {%- endif -%}\n  {%- endfor -%}\n{% endif %}\n")),(0,i.kt)("h2",{id:"link"},"Link"),(0,i.kt)("h3",{id:"with-attributes-in-nodehtmltwig"},"With attributes, in node.html.twig"),(0,i.kt)("p",null,"If, for whatever reason you do not wish to override a field template, links can be accessed in the entity template."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'For "Link with target" form field')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"{% if content.MY_LINK_FIELD %}\n  {% for key, item in content.MY_LINK_FIELD if key|first != '#' %}\n    <a href=\"{{ item['#url'] }}\" class=\"btn\" {% if item['#options'].attributes.target %} target=\"{{ item['#options'].attributes.target }}\" {% endif %}>\n      {{ item['#title'] }}\n    </a>\n  {% endfor %}\n{% endif %}\n")),(0,i.kt)("p",null,"A note on titles: It may sometimes be necessary to override the stock drupal title behavior if a default is needed to be provided. By default, if empty, it outputs the relative path as text."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"{% set title = item.content['#title'] %}\n{% if item.content['#url']|render == title %}\n  {% set title = 'Read More' %}\n{% endif %}\n")),(0,i.kt)("h2",{id:"media-and-image-fields"},"Media and Image fields"),(0,i.kt)("p",null,"Examples of media and images fields being rendered within a twig template. Can be optionally passed through an image style filter. Note: the image_style filter is provided by the ",(0,i.kt)("a",{parentName:"p",href:"https://www.drupal.org/project/twig_tweak"},"twig tweak")," module."),(0,i.kt)("h3",{id:"media-field-in-twig"},"Media field in twig"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"<img src=\"{{ file_url(content.field_carousel_item_image[0]['#media'].field_media_image.entity.uri.value | image_style('optimized')) }}\" alt=\"{{ content.field_carousel_item_image[0]['#media'].field_media_image.alt }}\">\n")),(0,i.kt)("h3",{id:"media-field-preproccess"},"Media Field preproccess."),(0,i.kt)("p",null,"If you need an image URL, and a default image URL. Following assumes a node, and that ",(0,i.kt)("inlineCode",{parentName:"p"},"$node")," is set with the node entity."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use Drupal\\media\\Entity\\Media;\nuse Drupal\\image\\Entity\\ImageStyle;\n\n// Background image URL, with fallback.\n$variables['profile_image'] = 'YOUR_BACKUP_IMAGE_URL';\nif ($node->hasField('field_profile_image')) {\n  $profile_image = $node->get('field_profile_image')->getValue();\n  if ($profile_image && !empty($profile_image)) {\n    $entity = Media::load($profile_image[0]['target_id']);\n    if (isset($entity) && $entity->field_media_image->entity !== NULL && $entity->field_media_image->entity->getFileUri() !== NULL) {\n      $variables['profile_image'] = ImageStyle::load('DESIRED_IMAGE_STYLE')->buildUrl($entity->field_media_image->entity->getFileUri());\n    }\n  }\n}\n")),(0,i.kt)("h3",{id:"image-field"},"Image field"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"<img src=\"{{ file_url(content.field_news_feature_image|field_target_entity.uri.value | image_style('optimized')) }}\" alt=\"{{ content.field_news_feature_image['#items'].alt }}\">\n")),(0,i.kt)("p",null,"Handle a default image reference in a twig template. Preprocess might be cleaner here but does keep all functionality within the twig template."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-twig"},"{% set thumbnail = assets_path ~ '/img/icons/News_Thumbnail_Placeholder.svg' %}\n{% set thumbnail_alt = '' %}\n{% if content.field_news_image|field_value %}\n  {% set thumbnail = file_url(content.field_news_image|field_target_entity.uri.value | image_style('optimized')) %}\n  {% set thumbnail_alt = content.field_news_image['#items'].alt %}\n{% elseif content.field_news_feature_image|field_value %}\n  {% set thumbnail = file_url(content.field_news_feature_image|field_target_entity.uri.value | image_style('optimized')) %}\n  {% set thumbnail_alt = content.field_news_feature_image['#items'].alt %}\n{% endif %}\n")))}m.isMDXComponent=!0}}]);
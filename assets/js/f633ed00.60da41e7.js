"use strict";(self.webpackChunkidfive_docs=self.webpackChunkidfive_docs||[]).push([[8477],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(a),h=o,m=u["".concat(s,".").concat(h)]||u[h]||c[h]||r;return a?n.createElement(m,i(i({ref:t},p),{},{components:a})):n.createElement(m,i({ref:t},p))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var d=2;d<r;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},4385:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var n=a(7462),o=(a(7294),a(3905));const r={},i="Drupal 8 General Codebase",l={unversionedId:"back-end/drupal/drupal",id:"back-end/drupal/drupal",title:"Drupal 8 General Codebase",description:'Unless specifically directed, all new D8 sites should attempt to use a composer based workflow for updates, and the idfive Component Library for the frontend. Some sites for specific clients, require different, specific workflows. This is not a substitute for that, rather, simply defines our "standard go-to\'s".',source:"@site/docs/back-end/drupal/drupal.md",sourceDirName:"back-end/drupal",slug:"/back-end/drupal/",permalink:"/docs/back-end/drupal/",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/back-end/drupal/drupal.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Drupal Views",permalink:"/docs/back-end/drupal/drupal-views"},next:{title:"PHP",permalink:"/docs/category/php"}},s={},d=[{value:"Local ENV Setup, and coding standards",id:"local-env-setup-and-coding-standards",level:2},{value:"Preferred local VS Code setup",id:"preferred-local-vs-code-setup",level:3},{value:"Preferred general site scaffolding",id:"preferred-general-site-scaffolding",level:3},{value:"Preferred general site spin-up workflow",id:"preferred-general-site-spin-up-workflow",level:2},{value:"Pantheon",id:"pantheon",level:3},{value:"Standard, non composer (via pantheon dashboard and lando)",id:"standard-non-composer-via-pantheon-dashboard-and-lando",level:4},{value:"Standard, non composer (via terminus and lando)",id:"standard-non-composer-via-terminus-and-lando",level:4},{value:"Standard, via the IAL",id:"standard-via-the-ial",level:4},{value:"Composer based, manually",id:"composer-based-manually",level:4},{value:"Set up buddy deploys to pantheon",id:"set-up-buddy-deploys-to-pantheon",level:4},{value:"Acquia",id:"acquia",level:3},{value:"idfive DEV server",id:"idfive-dev-server",level:3},{value:"Composer Based D8 Cores",id:"composer-based-d8-cores",level:2},{value:"Pantheon composer Based D8 Cores",id:"pantheon-composer-based-d8-cores",level:3},{value:"Pantheon Non CI",id:"pantheon-non-ci",level:4},{value:"Acquia composer Based D8 Cores",id:"acquia-composer-based-d8-cores",level:3},{value:"Acquia Non CI",id:"acquia-non-ci",level:4},{value:"Others",id:"others",level:3}],p={toc:d},u="wrapper";function c(e){let{components:t,...a}=e;return(0,o.kt)(u,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"drupal-8-general-codebase"},"Drupal 8 General Codebase"),(0,o.kt)("p",null,"Unless specifically directed, all new D8 sites should attempt to use a composer based workflow for updates, and the ",(0,o.kt)("a",{parentName:"p",href:"https://bitbucket.org/idfivellc/idfive-component-library"},"idfive Component Library"),' for the frontend. Some sites for specific clients, require different, specific workflows. This is not a substitute for that, rather, simply defines our "standard go-to\'s".'),(0,o.kt)("h2",{id:"local-env-setup-and-coding-standards"},"Local ENV Setup, and coding standards"),(0,o.kt)("h3",{id:"preferred-local-vs-code-setup"},"Preferred local VS Code setup"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Please follow the ",(0,o.kt)("a",{parentName:"li",href:"https://www.drupal.org/docs/develop/development-tools/configuring-visual-studio-code"},"following drupal.org article")," to set up VS Code for better drupal development locally."),(0,o.kt)("li",{parentName:"ul"},"Additionally, consider installing a spell checker plugin for VS Code.")),(0,o.kt)("h3",{id:"preferred-general-site-scaffolding"},"Preferred general site scaffolding"),(0,o.kt)("p",null,"Although exact setup will vary by client and environment, the ideal idfive d8 scaffolding resembles the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"  Site Root\n    composer.json | that wiill not be overwritten, where custom modules/etc can be added\n    web/docroot | where all core and custom code lives\n      modules\n        contrib | Where all contrib/composer based modules go\n        custom | Where any custom modules for client/project go\n          CLIENT_BASE_MODULE | One overarching module for any customizations that generally go with the custom client theme, but need to be in a module.\n            modules | Submodules. Mainly, this will be Kitchen Sink widgets and the like. They should get their own sub-modules so updates can potentially happen in the future.\n      themes\n        contrib\n          idfive\n        custom\n          CLIENT_BASE_THEME | child theme of idfive\n")),(0,o.kt)("h2",{id:"preferred-general-site-spin-up-workflow"},"Preferred general site spin-up workflow"),(0,o.kt)("p",null,"Regardless of platform, the general SOP for idfive drupal sites is:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create local and remote core installs."),(0,o.kt)("li",{parentName:"ul"},"Add standard idfive ICL Base theme."),(0,o.kt)("li",{parentName:"ul"},"Create custom child theme for client. All custom front end/etc go here."),(0,o.kt)("li",{parentName:"ul"},"Create a custom module/module suite for the client. All module related development and possibly config will go here."),(0,o.kt)("li",{parentName:"ul"},"Add core suite of idfive approved contrib modules."),(0,o.kt)("li",{parentName:"ul"},"Add other contrib modules as needed, but don't go overboard.")),(0,o.kt)("h3",{id:"pantheon"},"Pantheon"),(0,o.kt)("p",null,"Pantheon is the preferred platform to spin up DEV sites. Since lots of times, pantheon is only the temporary home of projects while in development, we have not yet created a custom idfive upstream, though that is not out of the question. For pantheon based sites, we utilize ",(0,o.kt)("a",{parentName:"p",href:"https://docs.lando.dev/"},"lando")," for local development, and to help keep sites in sync between local/remote/etc. Utilize the following workflow, assuming you have been assigned to the idfive team on pantheon."),(0,o.kt)("p",null,"One issue with pantheon is that we don't get a true composer based workflow out of the box."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Standard, non composer: This is a bit of a misnomer, as you can use composer to install modules and libraries, but they may be lost upon core updates/etc. Client receives core upstream updates from pantheon."),(0,o.kt)("li",{parentName:"ul"},'Composer based: This is a little more tricky as there is currently not a "one click" solution for this, however, we have created some helper scripts below. Client does not receive core upstream updates from pantheon, it has to update via composer manually.'),(0,o.kt)("li",{parentName:"ul"},"Also consider installing ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/pantheon-systems/terminus-site-clone-plugin"},"terminus Site Clone")," which can quickly clone sites for a starter.")),(0,o.kt)("p",null,"For this reason, we as of now, normally spin up a standard install if a client will be continuing on with pantheon, as the updates happening automatically are extremely important."),(0,o.kt)("h4",{id:"standard-non-composer-via-pantheon-dashboard-and-lando"},"Standard, non composer (via pantheon dashboard and lando)"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create a new sandbox in pantheon. Be sure this is assigned to the idfive team, not your personal account, so all Devs may access."),(0,o.kt)("li",{parentName:"ul"},"Go ahead and set up that site on the DEV URL, ie install the site."),(0,o.kt)("li",{parentName:"ul"},"Change pantheon from SFTP mode to GIT mode for the new site in the pantheon dashboard."),(0,o.kt)("li",{parentName:"ul"},"If you have not already, set up ",(0,o.kt)("a",{parentName:"li",href:"https://docs.lando.dev/"},"lando")," locally, and set it up for use with ",(0,o.kt)("a",{parentName:"li",href:"https://docs.lando.dev/config/pantheon.html"},"pantheon"),". It will require a ",(0,o.kt)("a",{parentName:"li",href:"https://pantheon.io/docs/machine-tokens#authenticate-into-terminus"},"machine token")," and a few other things."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cd ~/Sites")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"mkdir MY-LOCAL-SITE-lando")," (use the -lando at the end so you know this repo is served by lando)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cd MY-LOCAL-SITE-lando")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"lando init --source pantheon")," and go through the prompts to select the site you created in step one."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"lando start")," starts the app. It will also list the URL to access this locally."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"lando pull")," will pull DB/code/files from chosen environment through prompts.")),(0,o.kt)("p",null,"At this point, you have a local version of the blank site that is up on pantheon. Begin setting up themes/modules/etc as needed."),(0,o.kt)("h4",{id:"standard-non-composer-via-terminus-and-lando"},"Standard, non composer (via terminus and lando)"),(0,o.kt)("p",null,"Uses pantheons command line tool, ",(0,o.kt)("a",{parentName:"p",href:"https://pantheon.io/docs/terminus"},"terminus"),". Allows command line creation and install of pantheon site, then pulls down locally and runs via lando."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Be sure ",(0,o.kt)("a",{parentName:"li",href:"https://pantheon.io/docs/terminus"},"terminus")," is installed and running locally. If the bin directory is unavailable on install, Terminus cannot be automatically set up as a command. A symlink or an alias to the Terminus executable must be made in either the ~/.bashrc or ~/.bash_profile files, a la ",(0,o.kt)("inlineCode",{parentName:"li"},'alias terminus="/usr/local/bin/terminus"')),(0,o.kt)("li",{parentName:"ul"},"If you have not already, set up ",(0,o.kt)("a",{parentName:"li",href:"https://docs.lando.dev/"},"lando")," locally, and set it up for use with ",(0,o.kt)("a",{parentName:"li",href:"https://docs.lando.dev/config/pantheon.html"},"pantheon"),". It will require a ",(0,o.kt)("a",{parentName:"li",href:"https://pantheon.io/docs/machine-tokens#authenticate-into-terminus"},"machine token")," and a few other things."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terminus site:create SITE-MACHINE-NAME 'SITE HUMAN NAME' drupal8 --org=idfive-llc")," This will create a new site on pantheon, as drupal 8, under the idfive team."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terminus drush SITE-MACHINE-NAME.dev -- site:install --site-name=SITE-MACHINE-NAME --account-name=USERNAME --account-mail=EMAIL --account-pass=PASSWORD")," run site install on site you just created, on dev environment of pantheon. You will receive the message \"You are about to DROP all tables in your 'pantheon' database\", this is normal, continue. Note there is an open bug against a password containing certain chars, like ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/drush-ops/drush/issues/125"},"!%&'"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"terminus connection:set SITE-MACHINE-NAME.dev git")," set connection to git"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cd ~/Sites")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"mkdir SITE-MACHINE-NAME-lando")," (use the -lando at the end so you know this repo is served by lando)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cd SITE-MACHINE-NAME-lando")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'lando init --source pantheon --pantheon-site "SITE-MACHINE-NAME"')," and go through the prompts to select the site you created."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"lando start")," starts the app. It will also list the URL to access this locally."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"lando pull")," will pull DB/code/files from chosen environment through prompts.")),(0,o.kt)("p",null,"At this point, you have a local version of the blank site that is up on pantheon. Begin setting up themes/modules/etc as needed."),(0,o.kt)("h4",{id:"standard-via-the-ial"},"Standard, via the IAL"),(0,o.kt)("p",null,"Install the ",(0,o.kt)("a",{parentName:"p",href:"https://bitbucket.org/idfivellc/idfive-automation-library"},"idfive Automation Library")," and run the ",(0,o.kt)("a",{parentName:"p",href:"https://bitbucket.org/idfivellc/idfive-automation-library/src/master/drupal/pantheon/create_new_pantheon_site.sh"},"Create new site on pantheon, and spin up locally")," script. Adds all above lando/terminus commands into one file, that asks for machine name, theme name and human name, then runs all above scripts as well as installs common modules, and creates a client sub-theme."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"sh ~/Sites/_ial/drupal/pantheon/create_new_pantheon_site.sh"))),(0,o.kt)("h4",{id:"composer-based-manually"},"Composer based, manually"),(0,o.kt)("p",null,"Follow the steps outlined for ",(0,o.kt)("a",{parentName:"p",href:"https://pantheon.io/docs/guides/drupal-8-composer-no-ci"},"composer based, non CI")," site setup. Or alternatively, ",(0,o.kt)("a",{parentName:"p",href:"https://pantheon.io/docs/guides/composer-convert"},"convert an existing site")," to a composer based build."),(0,o.kt)("h4",{id:"set-up-buddy-deploys-to-pantheon"},"Set up buddy deploys to pantheon"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"See ",(0,o.kt)("a",{parentName:"li",href:"https://vimeo.com/391350603"},"vimeo overview from Nick"),".")),(0,o.kt)("h3",{id:"acquia"},"Acquia"),(0,o.kt)("p",null,"For acquia based sites, we utilize ",(0,o.kt)("a",{parentName:"p",href:"https://www.acquia.com/drupal/acquia-dev-desktop"},"Acquia Dev Desktop"),' for local development, and to help keep sites in sync between local/remote/etc. Since acquia based sites are normally created, and controlled by our clients, it is best to look at project specific documentation for any acquia based site. For acquia in particular, "spinning up a new site" often means adding a site to a multi-site setup.'),(0,o.kt)("h3",{id:"idfive-dev-server"},"idfive DEV server"),(0,o.kt)("p",null,"If possible, all DEV site sandboxes should use pantheon. If the project absolutely requires that it be on an idfive DEV server, see Nick, or a senior developer for access/etc. All deployments to the idfive server should have a repo setup on the ",(0,o.kt)("a",{parentName:"p",href:"https://bitbucket.org/"},"idfive bitbucket"),", and CI deployments set up through ",(0,o.kt)("a",{parentName:"p",href:"https://app.buddy.works/idfive"},"buddy"),". Be sure that someone has given you access to both accounts."),(0,o.kt)("h2",{id:"composer-based-d8-cores"},"Composer Based D8 Cores"),(0,o.kt)("p",null,"D8 core uses composer, but depending on the environment this is going to, slightly different setups must be enacted."),(0,o.kt)("h3",{id:"pantheon-composer-based-d8-cores"},"Pantheon composer Based D8 Cores"),(0,o.kt)("h4",{id:"pantheon-non-ci"},"Pantheon Non CI"),(0,o.kt)("p",null,"Mostly, we work without a CI at the moment, as most clients do not opt for the extra expense. See ",(0,o.kt)("a",{parentName:"p",href:"https://pantheon.io/docs/guides/drupal-8-composer-no-ci"},"Composer non CI")," docs for further information on setting up a pantheon repo for composer. This uses composer to manage updates, but commits these files to the codebase, rather than relying on a CI or build tool."),(0,o.kt)("h3",{id:"acquia-composer-based-d8-cores"},"Acquia composer Based D8 Cores"),(0,o.kt)("h4",{id:"acquia-non-ci"},"Acquia Non CI"),(0,o.kt)("p",null,"Mostly, we work without a CI at the moment, as most clients do not opt for the extra expense. See ",(0,o.kt)("a",{parentName:"p",href:"https://support.acquia.com/hc/en-us/articles/360004451293-Migrate-an-existing-D8-site-into-a-Composer-managed-build"},"Composer non CI")," docs for further information on setting up an acquia repo for composer. This uses composer to manage updates, but commits these files to the codebase, rather than relying on a CI or build tool."),(0,o.kt)("h3",{id:"others"},"Others"),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://www.drupal.org/docs/develop/using-composer/using-composer-with-drupal"},"Using composer with drupal")," for specifics."))}c.isMDXComponent=!0}}]);
"use strict";(self.webpackChunkidfive_docs=self.webpackChunkidfive_docs||[]).push([[5390],{6175:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"back-end/drupal/drupal-seven-migration","title":"Seven to 9 migration locally via lando","description":"See https://www.drupal.org/docs/upgrading-drupal/upgrade-using-drush. These are notes to be more sussed out on next run.","source":"@site/docs/back-end/drupal/drupal-seven-migration.md","sourceDirName":"back-end/drupal","slug":"/back-end/drupal/drupal-seven-migration","permalink":"/docs/back-end/drupal/drupal-seven-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/idfive/Developer-Documentation/tree/main/docs/back-end/drupal/drupal-seven-migration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Drupal 8 Services","permalink":"/docs/back-end/drupal/drupal-services"},"next":{"title":"Simple (per page) password protection in drupal","permalink":"/docs/back-end/drupal/drupal-simple-password-protection"}}');var l=r(4848),d=r(8453);const i={},s="Seven to 9 migration locally via lando",o={},t=[{value:"Setup",id:"setup",level:2},{value:"Example lando.yml",id:"example-landoyml",level:3},{value:"Example settings.php",id:"example-settingsphp",level:3},{value:"Migration Process",id:"migration-process",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"seven-to-9-migration-locally-via-lando",children:"Seven to 9 migration locally via lando"})}),"\n",(0,l.jsxs)(n.p,{children:["See ",(0,l.jsx)(n.a,{href:"https://www.drupal.org/docs/upgrading-drupal/upgrade-using-drush",children:"https://www.drupal.org/docs/upgrading-drupal/upgrade-using-drush"}),". These are notes to be more sussed out on next run."]}),"\n",(0,l.jsx)(n.p,{children:"This approach uses lando to create a separate DB locally."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lando composer require drupal/migrate_plus"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lando composer require drupal/migrate_tools"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lando composer require drupal/migrate_file"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,l.jsx)(n.h3,{id:"example-landoyml",children:"Example lando.yml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yml",children:"name: mywebsite\nrecipe: drupal8\nconfig:\n  webroot: web\n\n# Create Drupal 7 database service, for migration\nservices:\n  d7db:\n    type: mariadb\n    creds:\n      user: drupal7db\n      password: drupal7db\n      database: drupal7db\n    portforward: true\n"})}),"\n",(0,l.jsx)(n.h3,{id:"example-settingsphp",children:"Example settings.php"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"$databases['migrate']['default'] = [\n  'database' => 'drupal7db',\n  'username' => 'drupal7db',\n  'password' => 'drupal7db',\n  'prefix' => '',\n  'host' => 'd7db',\n  'port' => '3306',\n  'namespace' => 'Drupal\\\\Core\\\\Database\\\\Driver\\\\mysql',\n  'driver' => 'mysql',\n];\n"})}),"\n",(0,l.jsx)(n.h2,{id:"migration-process",children:"Migration Process"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Download the D7 DB, and install into lando locally via ",(0,l.jsx)(n.code,{children:"lando db-import --host=d7db --user=drupal7db MY_DB.sql"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["View the available migrations to later run: ",(0,l.jsx)(n.code,{children:"lando drush migrate:upgrade --legacy-db-key=migrate --legacy-root=https://MY-SITE.com --configure-only"}),"."]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lando drush migrate:status"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lando drush migrate:import --all"})}),"\n",(0,l.jsxs)(n.li,{children:["Import all d7 ",(0,l.jsx)(n.code,{children:'lando drush migrate:import --tag="Drupal 7"'})]}),"\n",(0,l.jsxs)(n.li,{children:["Reset ",(0,l.jsx)(n.code,{children:"lando drush migrate-rollback --all"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["See why a migration failed: ",(0,l.jsx)(n.code,{children:"lando drush mmsg MIGRATION_NAME"})]}),"\n",(0,l.jsxs)(n.li,{children:['"Migration MIGRATION_NAME is busy with another operation: Importing": ',(0,l.jsx)(n.code,{children:"lando drush migrate-reset-status MIGRATION_NAME"}),", resets that operation to idle in order to rerun."]}),"\n",(0,l.jsx)(n.li,{children:'"The "ENTITY" entity type does not exist": See if modules enabled'}),"\n",(0,l.jsxs)(n.li,{children:["Files not Importing: run ",(0,l.jsx)(n.code,{children:"lando drush migrate-import upgrade_d7_file"})," directly"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/back-end/drupal/drupal-legacy",children:"Drupal Legacy"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/back-end/drupal/drupal-environment",children:"Drupal Environment Setup"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/general/lando",children:"General Lando Documentation"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>s});var a=r(6540);const l={},d=a.createContext(l);function i(e){const n=a.useContext(d);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),a.createElement(d.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunkidfive_docs=self.webpackChunkidfive_docs||[]).push([[4070],{2519:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"back-end/drupal/drupal-deployment-standards","title":"Drupal Deployment Standards","description":"Launch preparation, code quality tools, and deployment standards for Drupal projects","source":"@site/docs/back-end/drupal/drupal-deployment-standards.md","sourceDirName":"back-end/drupal","slug":"/back-end/drupal/drupal-deployment-standards","permalink":"/docs/back-end/drupal/drupal-deployment-standards","draft":false,"unlisted":false,"editUrl":"https://github.com/idfive/Developer-Documentation/tree/main/docs/back-end/drupal/drupal-deployment-standards.md","tags":[],"version":"current","frontMatter":{"description":"Launch preparation, code quality tools, and deployment standards for Drupal projects"},"sidebar":"tutorialSidebar","previous":{"title":"Drupal Custom Development","permalink":"/docs/back-end/drupal/drupal-custom-development"},"next":{"title":"Entities","permalink":"/docs/back-end/drupal/drupal-entities"}}');var i=r(4848),d=r(8453);const l={description:"Launch preparation, code quality tools, and deployment standards for Drupal projects"},o="Drupal Deployment Standards",t={},a=[{value:"Prepping to Ship/Launch",id:"prepping-to-shiplaunch",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Versioning",id:"versioning",level:2},{value:"Packagist",id:"packagist",level:2},{value:"Example composer.json",id:"example-composerjson",level:3},{value:"Code Quality Tools",id:"code-quality-tools",level:2},{value:"PHP CodeSniffer/Drupal Coder",id:"php-codesnifferdrupal-coder",level:3},{value:"Drupal Check",id:"drupal-check",level:3},{value:"Examples",id:"examples",level:4},{value:"ESLint",id:"eslint",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"drupal-deployment-standards",children:"Drupal Deployment Standards"})}),"\n",(0,i.jsx)(n.h2,{id:"prepping-to-shiplaunch",children:"Prepping to Ship/Launch"}),"\n",(0,i.jsx)(n.p,{children:"Run through the entire idfive launch checklist for any site being launched by us. Additionally, consider the following:"}),"\n",(0,i.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsx)(n.p,{children:"Does your custom module rely on other custom or contrib modules?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yml",children:"dependencies:\n  - paragraphs\n  - SOME_OTHER_CUSTOM_MODULE\n  - link_attributes\n"})}),"\n",(0,i.jsx)(n.h2,{id:"versioning",children:"Versioning"}),"\n",(0,i.jsx)(n.p,{children:"If committing custom modules/themes for eventual composer builds, versioning must be enacted on the repo that deploys to composer. When ready to deploy, create a tag in github up one version from previous, with the starting version being 8.1.0:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Minor versions (non breaking changes): 8.1.1, 8.1.2, etc."}),"\n",(0,i.jsx)(n.li,{children:"Major versions (breaking changes): 8.2.0, 8.3.0, etc."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"packagist",children:"Packagist"}),"\n",(0,i.jsx)(n.p,{children:"If this module/theme is to be controlled via composer/packagist:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure a proper composer.json is created in the repo."}),"\n",(0,i.jsx)(n.li,{children:"Create a package for it on packagist.org"}),"\n",(0,i.jsx)(n.li,{children:"Be sure a client contact/it dept/etc has access to the packagist repo as well"}),"\n",(0,i.jsx)(n.li,{children:"Set webhook to deploy to packagist on push, wherever the repo is located."}),"\n",(0,i.jsx)(n.li,{children:'Note any required drupal modules in the "require" section so they also get added via composer.'}),"\n",(0,i.jsx)(n.li,{children:"Be sure to tag a version number when ready to deploy or update, see versioning notes, but for D8 we prefer 8.1.0, 8.1.1, etc."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-composerjson",children:"Example composer.json"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "idfive/idfive_paragraphs",\n  "type": "drupal-module",\n  "description": "This module is designed to provide base idfive kitchen sink widgets.",\n  "keywords": ["Drupal"],\n  "homepage": "https://bitbucket.org/idfivellc/idfive-component-library-d8-paragraphs",\n  "license": "GPL-2.0+",\n  "authors": [\n    {\n      "name": "Dan Rogers",\n      "homepage": "https://www.drupal.org/u/dan_rogers",\n      "role": "Maintainer"\n    }\n  ],\n  "require": {\n    "drupal/external_data_source": "*",\n    "drupal/link_attributes": "*",\n    "drupal/paragraphs": "*",\n    "drupal/tablefield": "*",\n    "drupal/viewsreference": "*",\n    "drupal/webform": "*"\n  },\n  "support": {\n    "issues": "https://bitbucket.org/idfivellc/idfive-component-library-d8-paragraphs/issues",\n    "source": "https://bitbucket.org/idfivellc/idfive-component-library-d8-paragraphs"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"code-quality-tools",children:"Code Quality Tools"}),"\n",(0,i.jsx)(n.h3,{id:"php-codesnifferdrupal-coder",children:"PHP CodeSniffer/Drupal Coder"}),"\n",(0,i.jsxs)(n.p,{children:["Before shipping custom themes and modules, run ",(0,i.jsx)(n.a,{href:"https://www.drupal.org/node/1587138",children:"drupal coder"})," in order to fix formatting issues/etc, and to ensure we ship code that matches the drupal coding standard."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Install ",(0,i.jsx)(n.a,{href:"https://www.drupal.org/node/1419988",children:"drupal coder"})," globally"]}),"\n",(0,i.jsxs)(n.li,{children:["See ",(0,i.jsx)(n.a,{href:"https://www.drupal.org/node/1587138",children:"coder example usage"})," for ideas on how to format/check custom code."]}),"\n",(0,i.jsxs)(n.li,{children:["Use phpcs: ",(0,i.jsx)(n.code,{children:"phpcs --standard=Drupal --extensions=php,module,inc,install,test,profile,theme,css,info,txt,md MY_CUSTOM_MODULE"})," to check"]}),"\n",(0,i.jsxs)(n.li,{children:["And then automated fixes via phpcbf: ",(0,i.jsx)(n.code,{children:"phpcbf --standard=Drupal --extensions=php,module,inc,install,test,profile,theme,css,info,txt,md MY_CUSTOM_MODULE"})]}),"\n",(0,i.jsx)(n.li,{children:"Be sure to double check code validity/etc."}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"--ignore=static"})," to ignore front end code/etc in a theme's static folder."]}),"\n",(0,i.jsxs)(n.li,{children:["See ",(0,i.jsx)(n.a,{href:"https://github.com/squizlabs/PHP_CodeSniffer/wiki/Advanced-Usage",children:"Advanced Usage"})," for ignoring directories/etc."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"drupal-check",children:"Drupal Check"}),"\n",(0,i.jsxs)(n.p,{children:["Install ",(0,i.jsx)(n.a,{href:"https://github.com/mglaman/drupal-check",children:"drupal-check"}),", which will give you the ability to run checks on custom modules/code to ensure you are not using any deprecated D8 functions that will be removed/etc. This static analysis tool will check for correctness (e.g. using a class that doesn't exist), deprecation errors, and more."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Install locally in lando via composer. ",(0,i.jsx)(n.code,{children:"lando composer require mglaman/drupal-check --dev"})]}),"\n",(0,i.jsxs)(n.li,{children:["Then run via ",(0,i.jsx)(n.code,{children:"lando php vendor/bin/drupal-check PATH/TO/YOUR/CUSTOM/CODE"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"lando php vendor/bin/drupal-check -d web/modules/custom/umd_terp_base"})," Check for deprecations in custom module"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"lando php vendor/bin/drupal-check -d web/themes/custom/umd_terp"})," Check for deprecations in custom theme"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"eslint",children:"ESLint"}),"\n",(0,i.jsx)(n.p,{children:"Generally speaking, we do not usually care about using ESLint for most JS files, as we normally have these going into a theme-based JS file, which has its own linters/builds/etc. If you do need to write vanilla D8 JS for a module, though, this can be a very useful tool to help get JS files to Drupal standards. ESLint is in core, you just need to install it in order to run it against specified files."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"cd core && yarn install"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"core/node_modules/.bin/eslint PATH_TO_YOUR_CUSTOM_JS.js"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"core/node_modules/.bin/eslint PATH_TO_YOUR_CUSTOM_JS.js --fix"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/back-end/drupal/drupal-custom-development",children:"Custom Development"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/back-end/drupal/drupal-content-architecture",children:"Content Architecture"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/back-end/drupal/drupal-testing",children:"Testing in Drupal"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/back-end/drupal/drupal-media-images",children:"Media & Images"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var s=r(6540);const i={},d=s.createContext(i);function l(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);